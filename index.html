<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CARPOOOO</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
</head>

<style>
    /* 사이드 메뉴 */
    .side-menu {
        position: fixed;
        top: 0;
        left: -280px;
        width: 280px;
        height: 100%;
        background: #fff;
        box-shadow: 2px 0 5px rgba(0, 0, 0, .2);
        transition: left 0.3s ease;
        padding: 20px;
        z-index: 2000;
        overflow-y: auto;
    }

    .side-menu.active {
        left: 0;
    }

    /* 사이드 메뉴 제목 */
    .side-menu p {
        text-align: left;
        color: #000;
        font-weight: bold;
        margin: 20px 0 10px;
        /* 여백 넉넉하게 */
    }

    /* 사이드 메뉴 상단 */
    .side-menu .menu-header {
        text-align: center;
    }

    .side-menu .menu-header h5 {
        color: #0d6efd;
        font-size: 1.25rem;
        margin-bottom: 10px;
    }

    /* 사이드 메뉴 리스트 */
    .side-menu .menu-list,
    .side-menu .menu-policy ul {
        list-style: none;
        padding-left: 0;
    }

    .side-menu .menu-list li,
    .side-menu .menu-policy li {
        margin: 10px 0;
    }

    .side-menu a {
        text-decoration: none;
        color: #333;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .side-menu a:hover {
        color: #0d6efd;
    }

    .side-menu .btn-link {
        color: #333;
        text-decoration: none;
    }

    .side-menu .btn-link:hover {
        color: #0d6efd;
    }

    .side-menu h6 {
        font-size: 1rem;
    }

    .side-menu p {
        margin: 0;
    }


    /* 오버레이 */
    .overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.3);
        z-index: 1500;
    }

    .overlay.active {
        display: block;
    }
</style>


<body>
    <!-- 상단 헤더 -->
    <div class="header">
        <div class="d-flex justify-content-between align-items-center">
            <!-- 로고 -->
            <h4 class="m-0 fw-bold">CARPOOOO</h4>
            <!-- 버튼 그룹-->
            <div class="d-flex align-items-center gap-1">
                <!-- 로그인 상태 영역 -->
                <div id="userStatus" class="me-2"></div>
                <!-- 알림창 -->
                <button class="btn btn-sm btn-link text-white"><i class="bi bi-ticket-perforated fs-4"></i></button>
                <!-- 알림창 -->
                <button class="btn btn-sm btn-link text-white"><i class="bi bi-bell fs-4"></i></button>
                <!-- 햄버거 버튼 -->
                <button id="menuBtn" class="btn btn-sm btn-link text-white"><i class="bi bi-list fs-3"></i></button>
            </div>
        </div>
    </div>
    </div>

    <!-- 사이드메뉴 -->
    <div id="sideMenu" class="side-menu">
        <!-- 상단: 설정 & 알림 -->
        <div class="d-flex justify-content-end gap-2 mb-3">
            <!-- 기어 아이콘 → 마이페이지 이동 -->
            <a href="mypage.html" class="btn btn-sm btn-link text-dark">
                <i class="bi bi-gear fs-5"></i>
            </a>

            <!-- 알림 아이콘 → 알림 페이지 이동 -->
            <a href="notifications.html" class="btn btn-sm btn-link text-dark">
                <i class="bi bi-bell fs-5"></i>
            </a>
        </div>

        <!-- 유저 프로필 영역 -->
        <div class="mb-4" id="sideUserArea"></div>


        <hr>

        <!-- 서비스메뉴 -->
        <p class="fw-bold small text-muted mb-1">서비스</p>
        <ul class="menu-list">
            <li><a href="car-profile.html">내 차</a></li>
            <li><a href="booking.html">예약하기</a></li>
            <li><a href="tickets.html">보관함</a></li>
            <li><a href="usage.html">이용내역</a></li>
            <li><a href="event.html">이벤트</a></li>
            <li><a href="support.html">1:1 문의</a></li>
            <li><a href="support.html">친구 초대하기</a></li>
        </ul>

        <hr>

        <!-- 약관 및 정책 -->
        <div class="menu-policy">
            <p class="fw-bold small text-muted mb-1">약관 및 정책</p>
            <ul>
                <li><a href="terms.html">이용약관</a></li>
                <li><a href="privacy.html">개인정보 처리방침</a></li>
                <li><a href="finance-terms.html">카푸 전자금융거래 이용약관(선불)</a></li>
                <li><a href="location-terms.html">위치기반 서비스 이용약관</a></li>
                <li><a href="location-privacy.html">개인위치정보 처리방침</a></li>
            </ul>
        </div>
    </div>

    <!-- 오버레이 -->
    <div id="overlay" class="overlay"></div>

    <!-- 퀵메뉴 -->
    <div class="quick-menu">
        <div class="quick-item" onclick="goMyCar()">
            <i class="bi bi-car-front-fill"></i>내 차
        </div>
        <div class="quick-item" onclick="location.href='booking.html'">
            <i class="bi bi-calendar-event"></i>예약하기
        </div>
        <div class="quick-item" onclick="location.href='tickets.html'">
            <i class="bi bi-ticket-perforated-fill"></i>보관함
        </div>
        <div class="quick-item" onclick="location.href='usage.html'">
            <i class="bi bi-clock-history"></i>이용내역
        </div>
    </div>

    <!-- 배너 캐러셀 -->
    <div id="promoCarousel" class="carousel slide px-3" data-bs-ride="carousel">
        <div class="carousel-inner rounded-3 overflow-hidden">
            <div class="carousel-item active"><img src="https://placehold.co/800x300" class="d-block w-100"
                    alt="할인 이벤트"></div>
            <div class="carousel-item"><img src="https://placehold.co/800x300" class="d-block w-100" alt="정기권 안내"></div>
        </div>
    </div>

    <!-- 배지 메뉴 -->
    <div class="badges">
        <div class="badge-item">최대 5만원 쿠폰</div>
        <div class="badge-item">이번달 쿠폰팩</div>
        <div class="badge-item">카푸 드로우</div>
        <div class="badge-item">이벤트 더보기</div>
    </div>

    <!-- 세차 꿀팁 카드 -->
    <div class="container mt-3">
        <h5 class="fw-bold mb-3">카푸의 차량관리 꿀팁</h5>
        <div class="row g-3">
            <div class="col-6 col-md-4">
                <div class="card card-tip"><img src="https://placehold.co/400x250" class="card-img-top">
                    <div class="card-body">
                        <p class="card-text">비 오는 날 세차가 좋은 이유</p>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-4">
                <div class="card card-tip"><img src="https://placehold.co/400x250" class="card-img-top">
                    <div class="card-body">
                        <p class="card-text">타이어 광택 관리 팁</p>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-4">
                <div class="card card-tip"><img src="https://placehold.co/400x250" class="card-img-top">
                    <div class="card-body">
                        <p class="card-text">실내 청소 꿀팁</p>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-4">
                <div class="card card-tip"><img src="https://placehold.co/400x250" class="card-img-top">
                    <div class="card-body">
                        <p class="card-text">겨울철 세차 주의사항</p>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-4">
                <div class="card card-tip"><img src="https://placehold.co/400x250" class="card-img-top">
                    <div class="card-body">
                        <p class="card-text">여름철 차량 관리법</p>
                    </div>
                </div>
            </div>
            <div class="col-6 col-md-4">
                <div class="card card-tip"><img src="https://placehold.co/400x250" class="card-img-top">
                    <div class="card-body">
                        <p class="card-text">세차 후 왁스 관리</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="text-center mt-3"><button class="btn btn-outline-primary btn-sm">더보기</button></div>
    </div>

    <!-- 세차상품 -->
    <div class="container mt-4">
        <h5 class="fw-bold mb-3">세차 상품권</h5>
        <div class="row">
            <div class="col-12 col-md-4">
                <div class="card product-card">
                    <div class="card-body text-center">
                        <h6 class="fw-bold">일반 세차</h6>
                        <p>1회 외부 세차</p>
                        <p class="fw-bold text-primary">25,000원~</p>
                        <button class="btn btn-primary btn-sm">예약하기</button>
                    </div>
                </div>
            </div>
            <div class="col-12 col-md-4">
                <div class="card product-card">
                    <div class="card-body text-center">
                        <h6 class="fw-bold">정기 세차</h6>
                        <p>월 4회 / 8회 패키지</p>
                        <p class="fw-bold text-primary">35,000원~</p>
                        <button class="btn btn-primary btn-sm">예약하기</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 푸터 -->
    <div class="footer">
        <p>© 2025 CARPOOOO. All rights reserved.</p>
        <p>고객센터: 010-1234-5678 | info@carpoo.com</p>
        <p>사업자등록번호: 123-45-67890</p>
    </div>
    <!-- 스크립트 모음-->
    <script>
        // 헤더 + 사이드메뉴 렌더링 함수
        function renderUserUI() {
            const userStatus = document.getElementById("userStatus");
            const sideUserArea = document.getElementById("sideUserArea");
            const currentUser = JSON.parse(localStorage.getItem("currentUser"));

            // 헤더: 프로필사진만
            if (userStatus) {
                if (currentUser) {
                    userStatus.innerHTML = `
          <div class="d-flex align-items-center">
            <img src="${currentUser.profileImage || 'https://placehold.co/40x40'}" 
                 alt="프로필" 
                 class="rounded-circle me-0" 
                 style="width:25px; height:25px; object-fit:cover;">
          </div>
        `;
                }
            }

            // 사이드메뉴: 이름/아이디/크레딧 or 로그인 안내
            if (sideUserArea) {
                if (currentUser) {
                    sideUserArea.innerHTML = `
                  <h6 class="fw-bold mb-1">${currentUser.name || "사용자"}</h6>
                  <p class="text-muted mb-1">@${currentUser.id || "userid"}</p>
                  <p class="fw-bold text-primary">Credit: ${(currentUser.points || 0).toLocaleString()}P</p>
                `;
                } else {
                    sideUserArea.innerHTML = `
                  <div class="text-center">
                    <a href="login.html" class="text-decoration-none text-muted small">
                      로그인하고 더 많은 서비스를 이용해보세요
                    </a>
                  </div>
                `;
                }
            }
        }

        // 초기 실행
        document.addEventListener("DOMContentLoaded", renderUserUI);
        // 🔥 뒤로가기 등 history navigation 시에도 실행
        window.addEventListener("pageshow", renderUserUI);

        function goMyCar() {
            const currentUser = JSON.parse(localStorage.getItem("currentUser"));

            if (!currentUser) {
                alert("로그인 후 이용 가능합니다.");
                window.location.href = "login.html";
                return;
            }

            if (!currentUser.cars || currentUser.cars.length === 0) {
                // 차량 등록 페이지
                window.location.href = "car-register.html";
            } else {
                // 등록된 차량이 있다면 프로필 페이지로 이동
                window.location.href = "car-profile.html";
            }
        }

        // 사이드메뉴 열고 닫기
        const menuBtn = document.getElementById("menuBtn");
        const sideMenu = document.getElementById("sideMenu");
        const overlay = document.getElementById("overlay");

        menuBtn.addEventListener("click", () => {
            sideMenu.classList.toggle("active");
            overlay.classList.toggle("active");
        });

        overlay.addEventListener("click", () => {
            sideMenu.classList.remove("active");
            overlay.classList.remove("active");
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>